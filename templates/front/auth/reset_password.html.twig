{% extends 'front/base_front.html.twig' %}

{% block title %}Set New Password - FAHIMNI{% endblock %}

{% block content %}
    <main class="auth-main">
        <div class="auth-container">
            <div class="auth-card">
                <div class="auth-header">
                    <h1>Set New Password</h1>
                    <p>Enter your new password below</p>
                </div>

                {% for type, messages in app.flashes %}
                    {% for message in messages %}
                        <div class="alert alert-{{ type }}" style="margin-bottom:1rem;padding:12px;border-radius:8px;{% if type == 'error' %}background:#fee2e2;color:#991b1b;border:1px solid #fecaca;{% else %}background:#d1fae5;color:#065f46;border:1px solid #a7f3d0;{% endif %}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endfor %}

                <form method="POST" class="auth-form">
                    <div class="form-group">
                        <label for="password">New Password</label>
                        <input type="password" id="password" name="password" placeholder="Enter new password" required minlength="6">
                        <small style="color:#6b7280;">Minimum 6 characters</small>
                    </div>

                    <div class="form-group">
                        <label for="confirmPassword">Confirm Password</label>
                        <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm new password" required minlength="6">
                        <span class="error-message" id="confirmError"></span>
                    </div>

                    <button type="submit" class="btn btn-primary btn-full">Reset Password</button>
                </form>

                <div class="auth-footer">
                    <p>Back to <a href="{{ path('app_login') }}">Login</a></p>
                </div>
            </div>

            <div class="auth-side">
                <div class="auth-side-content">
                    <h2>Create a Strong Password</h2>
                    <p>Make sure your new password is strong and unique to keep your account secure.</p>
                    <div class="auth-features">
                        <div class="auth-feature">
                            <span class="feature-icon">OK</span>
                            <span>At least 6 characters</span>
                        </div>
                        <div class="auth-feature">
                            <span class="feature-icon">OK</span>
                            <span>Mix of letters and numbers</span>
                        </div>
                        <div class="auth-feature">
                            <span class="feature-icon">OK</span>
                            <span>Avoid using personal info</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var form = document.querySelector('.auth-form');
            var passwordInput = document.getElementById('password');
            var confirmInput = document.getElementById('confirmPassword');
            var confirmError = document.getElementById('confirmError');

            if (form) {
                form.addEventListener('submit', function(e) {
                    var password = passwordInput.value.trim();
                    var confirm = confirmInput.value.trim();

                    confirmError.textContent = '';

                    if (password.length < 6) {
                        confirmError.textContent = 'Password must be at least 6 characters';
                        e.preventDefault();
                        return;
                    }

                    if (password !== confirm) {
                        confirmError.textContent = 'Passwords do not match';
                        e.preventDefault();
                        return;
                    }
                });
            }
        });
    </script>
{% endblock %}

