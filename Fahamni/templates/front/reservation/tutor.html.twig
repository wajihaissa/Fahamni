{% extends 'front/base_front.html.twig' %}

{% block title %}Tutor Dashboard - FAHIMNI{% endblock %}

{% block current_page %}tutors{% endblock %}

{% block stylesheets %}
<style>
/* Variables compl√©mentaires pour le dashboard (le reste vient de app.css) */
:root { --bg-card: var(--card-bg); --text-secondary: var(--text-light); --accent-color: var(--primary-dark); --success-color: #2ecc71; --warning-color: #f39c12; --danger-color: #e74c3c; --overlay: rgba(0,0,0,0.05); --overlay-hover: rgba(0,0,0,0.1); }
.dark-theme { --bg-card: var(--card-bg); --text-secondary: var(--text-light); --overlay: rgba(255,255,255,0.05); --overlay-hover: rgba(255,255,255,0.1); }

.dashboard-main { padding-bottom: 40px; }
.dashboard-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; flex-wrap: wrap; gap: 20px; }
.welcome-section h1 { font-size: 32px; color: var(--text-color); margin-bottom: 8px; }
.welcome-section p { color: var(--text-secondary); font-size: 16px; }
.quick-stats { display: flex; gap: 20px; }
.stat-card { background: var(--bg-card); padding: 20px; border-radius: 12px; box-shadow: var(--shadow); min-width: 140px; text-align: center; border: 1px solid var(--border-color); transition: transform 0.2s ease; }
.stat-card:hover { transform: translateY(-2px); box-shadow: var(--shadow-hover); }
.stat-number { font-size: 32px; font-weight: 700; color: var(--primary-color); margin-bottom: 5px; }
.stat-label { color: var(--text-secondary); font-size: 14px; font-weight: 500; }
.dashboard-content { display: grid; grid-template-columns: 1fr; gap: 30px; }
@media (min-width: 1024px) {
    .dashboard-content { grid-template-columns: 1fr 1fr; }
    .dashboard-section:nth-child(1) { grid-column: 1 / -1; }
    .dashboard-section:nth-child(4) { grid-column: 1 / -1; }
}
.dashboard-section { background: var(--bg-card); border-radius: 12px; padding: 25px; box-shadow: var(--shadow); border: 1px solid var(--border-color); transition: transform 0.2s ease; }
.dashboard-section:hover { transform: translateY(-2px); }
.section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
.section-header h2 { font-size: 20px; color: var(--text-color); font-weight: 600; }
.badge { background: var(--danger-color); color: white; padding: 4px 12px; border-radius: 20px; font-size: 14px; font-weight: 600; }
.view-all-link { color: var(--primary-color); text-decoration: none; font-size: 14px; font-weight: 500; }
.view-all-link:hover { text-decoration: underline; }
.requests-list { display: flex; flex-direction: column; gap: 20px; }
.request-card { border: 1px solid var(--border-color); border-radius: 10px; padding: 20px; background: var(--bg-card); transition: all 0.3s ease; }
.request-card:hover { box-shadow: var(--shadow-hover); border-color: var(--primary-color); }
.student-info { display: flex; gap: 15px; margin-bottom: 15px; align-items: flex-start; }
.student-avatar { width: 50px; height: 50px; background: var(--primary-color); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 18px; }
.student-details h3 { font-size: 18px; color: var(--text-color); margin-bottom: 4px; }
.student-details p { color: var(--text-secondary); font-size: 14px; margin-bottom: 10px; }
.request-meta { display: flex; gap: 20px; flex-wrap: wrap; font-size: 14px; color: var(--text-secondary); }
.request-message { background: var(--overlay); padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 3px solid var(--primary-color); }
.request-message p { font-style: italic; color: var(--text-color); }
.request-actions { display: flex; gap: 10px; flex-wrap: wrap; }
.sessions-list { display: flex; flex-direction: column; gap: 15px; }
.session-card { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-radius: 10px; border: 1px solid var(--border-color); background: var(--bg-card); flex-wrap: wrap; gap: 15px; transition: all 0.3s ease; }
.session-card:hover { border-color: var(--primary-color); }
.session-card.confirmed { border-left: 4px solid var(--success-color); }
.session-card.pending { border-left: 4px solid var(--warning-color); }
.session-time { min-width: 150px; }
.session-date { display: block; font-weight: 600; color: var(--text-color); font-size: 14px; }
.session-hours { display: block; color: var(--text-secondary); font-size: 13px; }
.session-info { flex: 1; min-width: 200px; }
.session-info h3 { font-size: 16px; color: var(--text-color); margin-bottom: 8px; }
.student-info-small { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
.student-avatar-small { width: 32px; height: 32px; background: var(--secondary-color); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; }
.session-details-small { display: flex; gap: 15px; font-size: 13px; color: var(--text-secondary); }
.session-actions { display: flex; gap: 8px; }
.performance-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 15px; }
.perf-card { display: flex; align-items: center; gap: 15px; padding: 20px; background: var(--overlay); border-radius: 10px; transition: transform 0.2s ease; }
.perf-card:hover { transform: translateY(-2px); background: var(--overlay-hover); }
.perf-icon { font-size: 32px; width: 60px; height: 60px; background: var(--bg-card); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: var(--shadow); }
.perf-content h3 { font-size: 28px; color: var(--text-color); margin-bottom: 4px; }
.perf-content p { color: var(--text-secondary); font-size: 14px; margin-bottom: 4px; }
.perf-change { font-size: 12px; font-weight: 500; }
.perf-change.positive { color: var(--success-color); }
.perf-change.negative { color: var(--danger-color); }
.period-selector { padding: 8px 15px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-card); color: var(--text-color); font-size: 14px; cursor: pointer; }
.reviews-list { display: flex; flex-direction: column; gap: 15px; margin-top: 15px; }
.review-card { padding: 20px; border: 1px solid var(--border-color); border-radius: 10px; background: var(--bg-card); transition: all 0.3s ease; }
.review-card:hover { border-color: var(--primary-color); }
.review-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
.review-rating { color: #f1c40f; letter-spacing: 2px; }
.review-date { color: var(--text-secondary); font-size: 13px; }
.review-text { color: var(--text-color); font-style: italic; line-height: 1.5; }
.student-name { font-weight: 600; color: var(--text-color); }
.btn-outline { background: transparent; color: var(--primary-color); border: 2px solid var(--primary-color); }
.btn-outline:hover { background: var(--primary-color); color: white; transform: translateY(-2px); box-shadow: var(--shadow-hover); }
.btn-small { padding: 8px 16px; font-size: 13px; }
@media (max-width: 768px) {
    .dashboard-header { flex-direction: column; align-items: flex-start; }
    .quick-stats { width: 100%; justify-content: space-between; }
    .stat-card { flex: 1; min-width: auto; padding: 15px; }
    .request-meta { flex-direction: column; gap: 5px; }
    .session-card { flex-direction: column; align-items: flex-start; }
    .session-actions { width: 100%; justify-content: flex-start; }
    .performance-cards { grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 480px) {
    .dashboard-main { padding: 90px 0 30px; }
    .performance-cards { grid-template-columns: 1fr; }
    .request-actions { flex-direction: column; }
    .request-actions .btn { width: 100%; min-height: 44px; }
    .welcome-section h1 { font-size: 22px; }
    .stat-card { padding: 14px; }
    .quick-stats { gap: 10px; }
    .dashboard-section { padding: 20px; }
}
</style>
{% endblock %}

{% block content %}
    <main class="dashboard-main">
        <div class="container">
            <div class="dashboard-header">
                <div class="welcome-section">
                    <h1>Welcome back, Dr. Roberts</h1>
                    <p>Manage your tutoring sessions and student interactions</p>
                </div>
                <div class="quick-stats">
                    <div class="stat-card">
                        <div class="stat-number">12</div>
                        <div class="stat-label">Active Students</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">4.9</div>
                        <div class="stat-label">Average Rating</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">$1,240</div>
                        <div class="stat-label">This Month</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-content">
                <div class="dashboard-section">
                    <div class="section-header">
                        <h2>Session Requests</h2>
                        <span class="badge">3</span>
                    </div>
                    <div class="requests-list">
                        <div class="request-card">
                            <div class="student-info">
                                <div class="student-avatar">SM</div>
                                <div class="student-details">
                                    <h3>Sarah Mitchell</h3>
                                    <p>Computer Science Student</p>
                                    <div class="request-meta">
                                        <span>üìÖ Dec 15, 2026 at 2:00 PM</span>
                                        <span>‚è∞ 1.5 hours</span>
                                        <span>üí∞ $67.50</span>
                                    </div>
                                </div>
                            </div>
                            <div class="request-message">
                                <p>"Hi! I need help with calculus derivatives, specifically the chain rule. I have an exam next week."</p>
                            </div>
                            <div class="request-actions">
                                <button class="btn btn-primary">Accept</button>
                                <button class="btn btn-outline">Decline</button>
                                <button class="btn btn-secondary">Message</button>
                            </div>
                        </div>
                        <div class="request-card">
                            <div class="student-info">
                                <div class="student-avatar">MK</div>
                                <div class="student-details">
                                    <h3>Mike Khan</h3>
                                    <p>Engineering Student</p>
                                    <div class="request-meta">
                                        <span>üìÖ Dec 16, 2026 at 4:00 PM</span>
                                        <span>‚è∞ 2 hours</span>
                                        <span>üí∞ $90.00</span>
                                    </div>
                                </div>
                            </div>
                            <div class="request-message">
                                <p>"Looking for help with linear algebra, particularly eigenvalues and eigenvectors for my final project."</p>
                            </div>
                            <div class="request-actions">
                                <button class="btn btn-primary">Accept</button>
                                <button class="btn btn-outline">Decline</button>
                                <button class="btn btn-secondary">Message</button>
                            </div>
                        </div>
                        <div class="request-card">
                            <div class="student-info">
                                <div class="student-avatar">AL</div>
                                <div class="student-details">
                                    <h3>Anna Lopez</h3>
                                    <p>Pre-Med Student</p>
                                    <div class="request-meta">
                                        <span>üìÖ Dec 17, 2026 at 10:00 AM</span>
                                        <span>‚è∞ 1 hour</span>
                                        <span>üí∞ $45.00</span>
                                    </div>
                                </div>
                            </div>
                            <div class="request-message">
                                <p>"Need help with statistics for my research methods course. Can we cover hypothesis testing?"</p>
                            </div>
                            <div class="request-actions">
                                <button class="btn btn-primary">Accept</button>
                                <button class="btn btn-outline">Decline</button>
                                <button class="btn btn-secondary">Message</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-section">
                    <div class="section-header">
                        <h2>Upcoming Sessions</h2>
                        <a href="#" class="view-all-link">View All</a>
                    </div>
                    <div class="sessions-list">
                        <div class="session-card confirmed">
                            <div class="session-time">
                                <span class="session-date">Today</span>
                                <span class="session-hours">2:00 PM - 3:00 PM</span>
                            </div>
                            <div class="session-info">
                                <h3>Calculus Review</h3>
                                <div class="student-info-small">
                                    <div class="student-avatar-small">JD</div>
                                    <span>John Doe</span>
                                </div>
                                <div class="session-details-small">
                                    <span class="session-mode">üíª Online</span>
                                    <span class="session-price">$45</span>
                                </div>
                            </div>
                            <div class="session-actions">
                                <button class="btn btn-primary btn-small">Join Session</button>
                                <button class="btn btn-secondary btn-small">Reschedule</button>
                            </div>
                        </div>
                        <div class="session-card confirmed">
                            <div class="session-time">
                                <span class="session-date">Tomorrow</span>
                                <span class="session-hours">10:00 AM - 12:00 PM</span>
                            </div>
                            <div class="session-info">
                                <h3>Statistics Workshop</h3>
                                <div class="student-info-small">
                                    <div class="student-avatar-small">EW</div>
                                    <span>Emma Wilson</span>
                                </div>
                                <div class="session-details-small">
                                    <span class="session-mode">üè´ In-Person</span>
                                    <span class="session-price">$90</span>
                                </div>
                            </div>
                            <div class="session-actions">
                                <button class="btn btn-secondary btn-small">Prepare</button>
                                <button class="btn btn-outline btn-small">Contact</button>
                            </div>
                        </div>
                        <div class="session-card pending">
                            <div class="session-time">
                                <span class="session-date">Dec 16</span>
                                <span class="session-hours">3:00 PM - 4:30 PM</span>
                            </div>
                            <div class="session-info">
                                <h3>Exam Preparation</h3>
                                <div class="student-info-small">
                                    <div class="student-avatar-small">RG</div>
                                    <span>Robert Garcia</span>
                                </div>
                                <div class="session-details-small">
                                    <span class="session-mode">üíª Online</span>
                                    <span class="session-price">$67.50</span>
                                </div>
                            </div>
                            <div class="session-actions">
                                <button class="btn btn-primary btn-small">Confirm</button>
                                <button class="btn btn-outline btn-small">Decline</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-section">
                    <div class="section-header">
                        <h2>Performance Overview</h2>
                        <select class="period-selector" id="performancePeriod">
                            <option value="week">This Week</option>
                            <option value="month" selected>This Month</option>
                            <option value="quarter">This Quarter</option>
                        </select>
                    </div>
                    <div class="performance-cards">
                        <div class="perf-card">
                            <div class="perf-icon">üìö</div>
                            <div class="perf-content">
                                <h3>18</h3>
                                <p>Sessions Completed</p>
                                <span class="perf-change positive">+12% vs last month</span>
                            </div>
                        </div>
                        <div class="perf-card">
                            <div class="perf-icon">‚≠ê</div>
                            <div class="perf-content">
                                <h3>4.9</h3>
                                <p>Average Rating</p>
                                <span class="perf-change positive">+0.1 vs last month</span>
                            </div>
                        </div>
                        <div class="perf-card">
                            <div class="perf-icon">üí∞</div>
                            <div class="perf-content">
                                <h3>$1,240</h3>
                                <p>Total Earnings</p>
                                <span class="perf-change positive">+18% vs last month</span>
                            </div>
                        </div>
                        <div class="perf-card">
                            <div class="perf-icon">üë•</div>
                            <div class="perf-content">
                                <h3>12</h3>
                                <p>Active Students</p>
                                <span class="perf-change positive">+2 new students</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-section">
                    <div class="section-header">
                        <h2>Recent Reviews</h2>
                        <a href="#" class="view-all-link">View All Reviews</a>
                    </div>
                    <div class="reviews-list">
                        <div class="review-card">
                            <div class="review-header">
                                <div class="student-info-small">
                                    <div class="student-avatar-small">JD</div>
                                    <div>
                                        <span class="student-name">John Doe</span>
                                        <div class="review-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                                    </div>
                                </div>
                                <span class="review-date">2 days ago</span>
                            </div>
                            <p class="review-text">"Dr. Roberts made calculus so much easier to understand. Her explanations are clear and she's very patient. Highly recommend!"</p>
                        </div>
                        <div class="review-card">
                            <div class="review-header">
                                <div class="student-info-small">
                                    <div class="student-avatar-small">EW</div>
                                    <div>
                                        <span class="student-name">Emma Wilson</span>
                                        <div class="review-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                                    </div>
                                </div>
                                <span class="review-date">1 week ago</span>
                            </div>
                            <p class="review-text">"Amazing tutor! She helped me improve my statistics grade from C to A. The session materials were excellent."</p>
                        </div>
                        <div class="review-card">
                            <div class="review-header">
                                <div class="student-info-small">
                                    <div class="student-avatar-small">MK</div>
                                    <div>
                                        <span class="student-name">Mike Khan</span>
                                        <div class="review-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                                    </div>
                                </div>
                                <span class="review-date">2 weeks ago</span>
                            </div>
                            <p class="review-text">"Great experience! Dr. Roberts is knowledgeable and creates a comfortable learning environment. Will book again."</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
{% endblock %}

{% block javascripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.request-actions .btn').forEach(function(button) {
        button.addEventListener('click', function() {
            var action = this.textContent.trim();
            var requestCard = this.closest('.request-card');
            this.style.transform = 'scale(0.95)';
            setTimeout(function() { button.style.transform = ''; }, 200);
            if (action === 'Accept') {
                alert('Request accepted! This session has been added to your calendar.');
                setTimeout(function() {
                    requestCard.style.opacity = '0';
                    requestCard.style.transform = 'translateX(-20px)';
                    setTimeout(function() {
                        requestCard.remove();
                        var badge = document.querySelector('.badge');
                        if (badge) badge.textContent = parseInt(badge.textContent, 10) - 1;
                    }, 300);
                }, 100);
            } else if (action === 'Decline') {
                if (confirm('Are you sure you want to decline this request?')) {
                    setTimeout(function() {
                        requestCard.style.opacity = '0';
                        requestCard.style.transform = 'translateX(20px)';
                        setTimeout(function() {
                            requestCard.remove();
                            var badge = document.querySelector('.badge');
                            if (badge) badge.textContent = parseInt(badge.textContent, 10) - 1;
                        }, 300);
                    }, 100);
                }
            } else if (action === 'Message') {
                alert('Messaging feature will be implemented soon!');
            }
        });
    });

    document.querySelectorAll('.session-actions .btn').forEach(function(button) {
        button.addEventListener('click', function() {
            var action = this.textContent.trim();
            this.style.transform = 'scale(0.95)';
            setTimeout(function() { button.style.transform = ''; }, 200);
            if (action === 'Join Session') {
                alert('Joining session... (Zoom/Meet integration would happen here)');
            } else if (action === 'Reschedule') {
                alert('Opening calendar to reschedule...');
            } else if (action === 'Confirm') {
                this.textContent = 'Confirmed';
                this.classList.remove('btn-primary');
                this.classList.add('btn-secondary');
                this.disabled = true;
                alert('Session confirmed!');
            } else if (action === 'Decline') {
                var sessionCard = this.closest('.session-card');
                if (confirm('Are you sure you want to decline this session?')) sessionCard.remove();
            } else if (action === 'Prepare') {
                alert('Opening session preparation materials...');
            } else if (action === 'Contact') {
                alert('Opening contact form...');
            }
        });
    });

    var performancePeriod = document.getElementById('performancePeriod');
    if (performancePeriod) {
        performancePeriod.addEventListener('change', function() {
            var period = this.value;
            var updates = { week: { sessions: 4, rating: 4.8, earnings: '$320', students: 2 }, month: { sessions: 18, rating: 4.9, earnings: '$1,240', students: 12 }, quarter: { sessions: 56, rating: 4.9, earnings: '$3,850', students: 15 } };
            var data = updates[period];
            if (data) {
                document.querySelectorAll('.perf-content h3').forEach(function(h3, index) {
                    if (index === 0) h3.textContent = data.sessions;
                    else if (index === 1) h3.textContent = data.rating;
                    else if (index === 2) h3.textContent = data.earnings;
                    else if (index === 3) h3.textContent = data.students;
                });
            }
        });
    }
});
</script>
{% endblock %}
